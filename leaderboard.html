<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Leaderboard Kuis Engineer</title>
    <!-- 1. Impor TailwindCSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- 2. Impor Font Inter -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    
    <style>
        body {
            font-family: 'Inter', sans-serif;
            --main-color: #8B0000;
            background-color: var(--main-color);
        }
        /* Animasi fade in untuk data baru */
        @keyframes fadeInRow {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .new-row {
            animation: fadeInRow 0.5s ease-in-out;
        }
    </style>
</head>
<body class="flex items-center justify-center min-h-screen p-4 md:p-8 bg-red-800">

    <!-- Kontainer Utama Aplikasi -->
    <div class="w-full max-w-4xl bg-white rounded-xl shadow-2xl overflow-hidden">
        
        <!-- Halaman 5: Leaderboard (Selalu Aktif) -->
        <div id="page-leaderboard" class="p-8 md:p-12">
            <h1 class="text-3xl md:text-4xl font-extrabold text-gray-900 text-center mb-6">Leaderboard Kuis Engineer</h1>
            
            <!-- Timer Hitung Mundur -->
            <div class="text-center bg-yellow-100 border border-yellow-300 text-yellow-800 p-4 rounded-lg mb-6">
                <h3 class="font-bold">Batas Waktu Pemenang Hadiah:</h3>
                <div id="countdown-timer" class="text-xl font-bold">12 November 2025, 15:00 WIB</div>
            </div>
            
            <!-- Tabel Leaderboard -->
            <div class="overflow-x-auto border rounded-lg">
                <table class="w-full text-left">
                    <thead class="bg-gray-50 border-b">
                        <tr>
                            <th class="p-3 font-semibold text-gray-700">Peringkat</th>
                            <th class="p-3 font-semibold text-gray-700">Nama</th>
                            <th class="p-3 font-semibold text-gray-700">Perusahaan</th>
                            <th class="p-3 font-semibold text-gray-700">Skor</th>
                            <th class="p-3 font-semibold text-gray-700">Waktu (detik)</th>
                        </tr>
                    </thead>
                    <tbody id="leaderboard-body">
                        <!-- Data akan diisi oleh JS -->
                        <tr>
                            <td colspan="5" class="p-8 text-center text-gray-500">
                                Memuat data leaderboard...
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
            
            <p class="text-center text-gray-500 text-sm mt-4">Leaderboard akan me-refresh data secara otomatis...</p>
        </div>
        
    </div>

    <script>
        // --- KONFIGURASI APLIKASI ---
        
        // !!! PENTING: Ganti dengan URL Google Apps Script Anda yang sudah di-deploy !!!
        const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbzZhYgIXWtIjJ77Hobg5xNrwE3yBP3SVa-xcD6FffAACuw32fzLVEy8qQkbq_s58H7p/exec';
        
        const TOTAL_QUESTIONS = 15;
        const REFRESH_INTERVAL = 15000; // 15 detik

        // --- Selektor DOM ---
        const leaderboardBody = document.getElementById('leaderboard-body');
        
        // --- Fungsi Leaderboard ---

        async function loadLeaderboard() {
            // Jangan tampilkan "Memuat..." jika sudah ada data, agar refresh terlihat mulus
            if (leaderboardBody.innerHTML.includes('colspan="5"')) {
                 leaderboardBody.innerHTML = `<tr><td colspan="5" class="p-8 text-center text-gray-500">Memuat data leaderboard...</td></tr>`;
            }
            
            try {
                // Tambahkan parameter cache-busting untuk mencegah data lama
                const response = await fetch(`${GOOGLE_SCRIPT_URL}?timestamp=${new Date().getTime()}`);
                if (!response.ok) throw new Error(`Gagal mengambil data (${response.status})`);
                
                const data = await response.json();
                
                leaderboardBody.innerHTML = ''; // Kosongkan tabel
                
                if (!data || data.length === 0) {
                    leaderboardBody.innerHTML = `<tr><td colspan="5" class="p-8 text-center text-gray-500">Belum ada data. Jadilah yang pertama!</td></tr>`;
                    return;
                }
                
                // Tampilkan data di tabel
                data.forEach((row, index) => {
                    const tr = document.createElement('tr');
                    // Terapkan kelas 'new-row' untuk animasi, tapi bisa dihilangkan jika terlalu berlebihan
                    tr.className = 'border-b hover:bg-gray-50 new-row'; 
                    
                    // Logika highlight user tidak diperlukan di halaman publik ini
                    
                    tr.innerHTML = `
                        <td class="p-3">${index + 1}</td>
                        <td class="p-3">${row.name}</td>
                        <td class="p-3">${row.company}</td>
                        <td class="p-3">${row.score} / ${TOTAL_QUESTIONS}</td>
                        <td class="p-3">${Number(row.duration).toFixed(1)}s</td>
                    `;
                    leaderboardBody.appendChild(tr);
                });

            } catch (error) {
                console.error('Error memuat leaderboard:', error);
                leaderboardBody.innerHTML = `<tr><td colspan="5" class="p-8 text-center text-red-500">Gagal memuat data leaderboard. Periksa koneksi atau URL Apps Script.</td></tr>`;
            }
        }
        
        // --- Inisialisasi Aplikasi ---
        document.addEventListener('DOMContentLoaded', () => {
            loadLeaderboard(); // Muat pertama kali
            setInterval(loadLeaderboard, REFRESH_INTERVAL); // Mulai auto-refresh
        });

    </script>
</body>
</html>
